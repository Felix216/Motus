<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motus - Sistema de Gesti√≥n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        motus: {
                            green: '#84cc16', // Verde Ne√≥n Identidad
                            bg: '#09090b',    // Fondo Negro
                            card: '#18181b',  // Paneles
                            border: '#27272a',// Bordes
                            hover: '#27272a',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #09090b; color: white; }
        .view-section { display: none; opacity: 0; transition: opacity 0.3s ease; }
        .active-view { display: flex; opacity: 1; }
        
        .nav-item.active { background-color: #27272a; color: white; border-left: 3px solid #84cc16; }
        .nav-item { border-left: 3px solid transparent; }
        
        /* Utility para inputs de fecha personalizados */
        .date-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23a1a1aa' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-appearance: none;
            appearance: none;
        }

        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #09090b; }
        ::-webkit-scrollbar-thumb { background: #27272a; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #84cc16; }
    </style>
</head>
<body class="h-screen w-full overflow-hidden text-sm font-sans selection:bg-motus-green selection:text-black">

    <section id="auth-layout" class="view-section active-view w-full h-full">
        <div class="hidden lg:flex w-1/2 bg-zinc-900 relative items-center justify-center overflow-hidden">
            <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1534438327276-14e5300c3a48?q=80&w=1470&auto=format&fit=crop')] bg-cover bg-center opacity-30 grayscale mix-blend-multiply"></div>
            <div class="relative z-10 p-16 max-w-xl">
                <div class="w-20 h-20 border-4 border-motus-green rounded-2xl flex items-center justify-center mb-8 shadow-[0_0_30px_rgba(132,204,22,0.3)]">
                    <span class="text-5xl font-black italic text-motus-green">M</span>
                </div>
                <h1 class="text-7xl font-black italic text-white mb-6 tracking-tighter leading-none">MOTUS<br><span class="text-transparent bg-clip-text bg-gradient-to-r from-motus-green to-emerald-600">SYSTEM</span></h1>
            </div>
        </div>

        <div class="w-full lg:w-1/2 bg-motus-bg flex flex-col justify-center p-8 sm:p-20 relative">
            
            <div id="form-login" class="w-full max-w-md mx-auto fade-in">
                <div class="mb-10">
                    <h2 class="text-3xl font-bold text-white mb-2">Iniciar Sesi√≥n</h2>
                    <p class="text-zinc-500">Accede a tu plataforma de entrenamiento.</p>
                </div>

                <div class="space-y-5">
                    <div>
                        <label class="text-xs font-bold text-motus-green uppercase tracking-wider">Email</label>
                        <input id="login-email" type="text" value="armin@motus.cl" class="w-full mt-2 p-4 bg-motus-card border border-motus-border rounded-xl focus:border-motus-green focus:outline-none text-white transition placeholder-zinc-700 font-medium" placeholder="ej. 12.345.678-9">
                    </div>
                    <div>
                        <label class="text-xs font-bold text-motus-green uppercase tracking-wider">Contrase√±a</label>
                        <input id="login-pass" type="password" value="1234" class="w-full mt-2 p-4 bg-motus-card border border-motus-border rounded-xl focus:border-motus-green focus:outline-none text-white transition placeholder-zinc-700 font-medium" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                </div>

                <button onclick="intentarLogin()" class="w-full mt-8 bg-motus-green text-black font-black py-4 rounded-xl hover:bg-lime-400 transition transform hover:-translate-y-1 shadow-lg shadow-motus-green/20 uppercase tracking-widest">
                    Ingresar
                </button>

                <div class="mt-8 flex justify-between items-center border-t border-motus-border pt-6">
                    <button onclick="toggleAuth('register')" class="text-zinc-500 hover:text-white text-xs font-bold uppercase underline decoration-zinc-700 underline-offset-4">Crear Cuenta</button>
                    <button onclick="loginAdminDemo()" class="text-zinc-600 hover:text-motus-green text-xs font-bold uppercase flex items-center gap-2">
                        <i class="fas fa-lock"></i> Acceso Administrativo
                    </button>
                </div>
            </div>

            <div id="form-register" class="w-full max-w-md mx-auto hidden">
                <button onclick="toggleAuth('login')" class="text-zinc-500 hover:text-white mb-6 flex items-center gap-2 text-xs font-bold uppercase hover:translate-x-[-5px] transition-transform">
                    <i class="fas fa-arrow-left"></i> Volver al Login
                </button>
                
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-white mb-2">Crear Cuenta</h2>
                    <p class="text-zinc-500">√önete a la comunidad Motus hoy mismo.</p>
                </div>

                <div class="space-y-4">
                    <div>
                        <label class="text-[10px] font-bold text-zinc-500 uppercase tracking-wider">Nombre Completo</label>
                        <input id="reg-nombre" type="text" class="w-full p-3 mt-1 bg-motus-card border border-motus-border rounded-lg focus:border-motus-green focus:outline-none text-white" placeholder="Tu nombre">
                    </div>
                    <div>
                        <label class="text-[10px] font-bold text-zinc-500 uppercase tracking-wider">RUT</label>
                        <input id="reg-rut" type="text" class="w-full p-3 mt-1 bg-motus-card border border-motus-border rounded-lg focus:border-motus-green focus:outline-none text-white" placeholder="12.345.678-9">
                    </div>

                    <div class="bg-zinc-900/50 p-4 rounded-xl border border-motus-border border-l-4 border-l-motus-green">
                        <label class="text-[10px] font-bold text-motus-green uppercase block mb-2">Fecha de Nacimiento <span class="text-zinc-500">(Requerido)</span></label>
                        <div class="grid grid-cols-3 gap-2">
                            <select id="reg-dia" class="date-select bg-motus-card border border-motus-border text-white rounded-lg p-2 text-center focus:border-motus-green focus:outline-none cursor-pointer"><option value="">D√≠a</option><option value="24">24</option><option value="01">01</option></select>
                            <select id="reg-mes" class="date-select bg-motus-card border border-motus-border text-white rounded-lg p-2 text-center focus:border-motus-green focus:outline-none cursor-pointer"><option value="">Mes</option><option value="Ene">Ene</option><option value="Feb">Feb</option></select>
                            <select id="reg-ano" class="date-select bg-motus-card border border-motus-border text-white rounded-lg p-2 text-center focus:border-motus-green focus:outline-none cursor-pointer"><option value="">A√±o</option><option value="1995">1995</option><option value="1996">1996</option></select>
                        </div>
                    </div>

                    <div>
                        <label class="text-[10px] font-bold text-zinc-500 uppercase tracking-wider">Email</label>
                        <input id="reg-email" type="email" class="w-full p-3 mt-1 bg-motus-card border border-motus-border rounded-lg focus:border-motus-green focus:outline-none text-white" placeholder="correo@ejemplo.com">
                    </div>
                    <div>
                        <label class="text-[10px] font-bold text-zinc-500 uppercase tracking-wider">Contrase√±a</label>
                        <input id="reg-pass" type="password" class="w-full p-3 mt-1 bg-motus-card border border-motus-border rounded-lg focus:border-motus-green focus:outline-none text-white" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                </div>

                <button onclick="registrarUsuario()" class="w-full mt-6 bg-transparent border-2 border-motus-green text-motus-green font-bold py-3 rounded-xl hover:bg-motus-green hover:text-black transition uppercase tracking-wide">
                    Registrarme
                </button>
            </div>
        </div>
    </section>

    <section id="layout-socio" class="view-section w-full h-full hidden">
        <aside class="w-64 bg-motus-card border-r border-motus-border flex flex-col flex-shrink-0 z-20">
            <div class="h-16 flex items-center px-6 border-b border-motus-border">
                <span class="font-black italic text-xl tracking-tight text-white"><span class="text-motus-green">M</span>OTUS APP</span>
            </div>
            <nav class="flex-1 px-3 py-6 space-y-1">
                <p class="px-3 text-[10px] font-bold text-zinc-500 uppercase tracking-widest mb-2">Mi Espacio</p>
                <button onclick="navTo('socio-news', this)" class="nav-item active w-full flex items-center gap-3 px-3 py-2.5 rounded-r-lg text-zinc-400 hover:bg-motus-hover hover:text-white transition group">
                    <i class="fas fa-newspaper w-5 text-center group-hover:text-motus-green"></i> <span class="font-medium">Novedades</span>
                </button>
                <button onclick="navTo('socio-calendar', this); renderizarCalendario();" class="nav-item w-full flex items-center gap-3 px-3 py-2.5 rounded-r-lg text-zinc-400 hover:bg-motus-hover hover:text-white transition group">
                    <i class="fas fa-calendar-alt w-5 text-center group-hover:text-motus-green"></i> <span class="font-medium">Reservar Clase</span>
                </button>
                <button onclick="navTo('socio-profile', this); cargarPerfil();" class="nav-item w-full flex items-center gap-3 px-3 py-2.5 rounded-r-lg text-zinc-400 hover:bg-motus-hover hover:text-white transition group">
                    <i class="fas fa-user-circle w-5 text-center group-hover:text-motus-green"></i> <span class="font-medium">Mi Perfil</span>
                </button>
            </nav>
            <div class="p-4 border-t border-motus-border flex items-center gap-3">
                <div id="mini-avatar" class="w-8 h-8 rounded-full bg-zinc-800 flex items-center justify-center text-motus-green font-bold text-xs">AH</div>
                <div class="flex-1"><p id="mini-nombre" class="text-xs font-bold text-white">Armin H.</p></div>
                <button onclick="logout()" class="text-zinc-500 hover:text-red-500"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </aside>

        <main class="flex-1 overflow-y-auto bg-motus-bg p-8 relative">
            
            <div id="socio-news" class="content-panel active-view flex-col max-w-5xl mx-auto w-full">
                <header class="mb-8"><h1 class="text-3xl font-bold text-white mb-1">Hola, <span id="news-nombre">Armin</span> üëã</h1><p class="text-zinc-400">Aqu√≠ tienes lo √∫ltimo de Motus.</p></header>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-1 space-y-6">
                        <div id="next-session-card" class="bg-motus-card border border-motus-green rounded-2xl p-6 relative overflow-hidden group min-h-[150px] flex flex-col justify-center">
                            </div>
                    </div>
                    <div class="lg:col-span-2 space-y-4">
                        <div class="bg-zinc-900 border-l-4 border-motus-green p-5 rounded-r-xl flex gap-4">
                            <div class="bg-motus-green/10 w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0 text-motus-green"><i class="fas fa-bullhorn"></i></div>
                            <div><h4 class="font-bold text-white text-lg">Horario Especial</h4><p class="text-zinc-400 text-sm mt-1">Atenci√≥n reducida este viernes por mantenci√≥n.</p><span class="text-[10px] text-zinc-500 mt-2 block">Hace 2 horas ‚Ä¢ Admin</span></div>
                        </div>
                        <div class="bg-motus-card border border-motus-border p-5 rounded-xl flex gap-4 hover:border-zinc-600 transition">
                            <div class="bg-blue-500/10 w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0 text-blue-400"><i class="fas fa-apple-alt"></i></div>
                            <div><h4 class="font-bold text-white">Nuevo servicio de Nutrici√≥n</h4><p class="text-zinc-400 text-sm mt-1">Reserva tu evaluaci√≥n inicial desde la agenda.</p></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="socio-calendar" class="content-panel hidden flex-col max-w-[1600px] mx-auto w-full h-full">
                <div class="flex justify-between items-center mb-6">
                    <div><h2 class="text-3xl font-black italic text-white tracking-tight">AGENDA SEMANAL</h2><p class="text-zinc-500 text-sm">Reserva visual de cupos.</p></div>
                    <div class="flex gap-2 bg-motus-card p-1 rounded-xl border border-motus-border">
                        <button class="px-4 py-2 bg-motus-green text-black rounded-lg text-xs font-black uppercase hover:bg-lime-400 transition">Esta Semana</button>
                    </div>
                </div>

                <div class="flex-1 bg-motus-card border border-motus-border rounded-2xl overflow-hidden flex flex-col shadow-2xl min-h-[600px]">
                    <div class="grid grid-cols-5 border-b border-motus-border bg-black">
                        <div class="p-4 text-center border-r border-motus-border"><span class="block text-zinc-500 text-[10px] font-bold uppercase">Lunes</span></div>
                        <div class="p-4 text-center border-r border-motus-border bg-motus-green/5 relative"><div class="absolute top-0 left-0 w-full h-1 bg-motus-green"></div><span class="block text-motus-green text-[10px] font-bold uppercase">Martes (Hoy)</span></div>
                        <div class="p-4 text-center border-r border-motus-border"><span class="block text-zinc-500 text-[10px] font-bold uppercase">Mi√©rcoles</span></div>
                        <div class="p-4 text-center border-r border-motus-border"><span class="block text-zinc-500 text-[10px] font-bold uppercase">Jueves</span></div>
                        <div class="p-4 text-center"><span class="block text-zinc-500 text-[10px] font-bold uppercase">Viernes</span></div>
                    </div>

                    <div class="grid grid-cols-5 flex-1 divide-x divide-motus-border overflow-y-auto bg-zinc-900/30">
                        <div id="col-lun" class="p-3 space-y-3"></div>
                        <div id="col-mar" class="p-3 space-y-3 bg-motus-green/5"></div>
                        <div id="col-mie" class="p-3 space-y-3"></div>
                        <div id="col-jue" class="p-3 space-y-3"></div>
                        <div id="col-vie" class="p-3 space-y-3"></div>
                    </div>
                </div>
            </div>

            <div id="socio-profile" class="content-panel hidden flex-col p-6 sm:p-10 max-w-6xl mx-auto w-full">
                <header class="mb-8 flex justify-between items-center"><h2 class="text-3xl font-black italic text-white tracking-tight">MI PERFIL</h2><button class="border border-motus-border text-zinc-400 px-4 py-2 rounded-lg text-xs font-bold uppercase hover:text-white"><i class="fas fa-pen"></i> Editar</button></header>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    
                    <div class="lg:col-span-1 space-y-6">
                        <div class="bg-motus-card border border-motus-border rounded-3xl p-8 flex flex-col items-center text-center relative overflow-hidden">
                            <div class="absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-motus-green/10 to-transparent"></div>
                            <div class="relative w-32 h-32 bg-zinc-900 rounded-full flex items-center justify-center border-4 border-motus-green mb-4 shadow-lg"><span id="profile-initials" class="text-4xl font-black text-white italic">AH</span></div>
                            <h3 id="profile-name-main" class="text-2xl font-black text-white italic tracking-tight mb-1">Armin Hucke</h3>
                            
                            <div class="inline-flex items-center gap-2 bg-motus-green/10 text-motus-green px-4 py-1.5 rounded-full border border-motus-green/20 mb-6"><span class="relative flex h-2 w-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-motus-green opacity-75"></span><span class="relative inline-flex rounded-full h-2 w-2 bg-motus-green"></span></span><span class="text-xs font-black uppercase tracking-widest">Activo</span></div>
                            
                            <div class="w-full bg-zinc-900 rounded-xl p-4 border border-motus-border text-left"><div class="flex justify-between items-end mb-2"><span class="text-[10px] font-bold text-zinc-500 uppercase">Asistencia Mensual</span><span class="text-sm font-black text-white">12/20</span></div><div class="w-full bg-zinc-800 h-2 rounded-full overflow-hidden"><div class="bg-motus-green h-full rounded-full" style="width: 60%"></div></div></div>
                            
                             <div class="w-full bg-zinc-900 rounded-xl p-4 border border-motus-border text-left mt-4">
                                <h4 class="text-[10px] font-bold text-zinc-500 uppercase mb-3">Mis Reservas Activas</h4>
                                <div id="lista-reservas-perfil" class="space-y-2">
                                    </div>
                            </div>
                        </div>
                    </div>

                    <div class="lg:col-span-2 space-y-6">
                        <div class="bg-motus-card border border-motus-border rounded-3xl p-8">
                            <h3 class="text-lg font-bold text-white uppercase italic mb-6 border-b border-motus-border pb-4">Informaci√≥n Personal</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-y-6 gap-x-8">
                                <div><label class="block text-[10px] font-bold text-zinc-500 uppercase mb-2">Nombre</label><div id="info-nombre" class="p-3 bg-zinc-900/50 rounded-xl border border-zinc-800 text-white font-medium">Armin Hucke</div></div>
                                <div><label class="block text-[10px] font-bold text-zinc-500 uppercase mb-2">RUT</label><div id="info-rut" class="p-3 bg-zinc-900/50 rounded-xl border border-zinc-800 text-white font-medium">12.345.678-9</div></div>
                                <div><label class="block text-[10px] font-bold text-zinc-500 uppercase mb-2">Email</label><div id="info-email" class="p-3 bg-zinc-900/50 rounded-xl border border-zinc-800 text-white font-medium">armin@motus.cl</div></div>
                                <div><label class="block text-[10px] font-bold text-zinc-500 uppercase mb-2">F. Nacimiento</label><div class="p-3 bg-zinc-900/50 rounded-xl border border-zinc-800 text-white font-medium">24 Ene 1995</div></div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-motus-card border border-motus-border rounded-3xl p-6">
                                <h3 class="font-bold text-white uppercase italic mb-4"><i class="fas fa-ticket-alt text-blue-400 mr-2"></i>Mi Plan</h3>
                                <div class="space-y-4">
                                    <div class="flex justify-between border-b border-zinc-800 pb-2"><span class="text-xs text-zinc-400">Tipo</span><span id="info-plan" class="text-sm font-bold text-white">Full Access</span></div>
                                    <div class="flex justify-between items-center bg-motus-green/5 p-2 rounded"><span class="text-xs text-zinc-400">Vence</span><span class="text-sm font-black text-motus-green">01 Dic 2025</span></div>
                                </div>
                            </div>
                            <div class="bg-motus-card border border-motus-border rounded-3xl p-6">
                                <h3 class="font-bold text-white uppercase italic mb-4"><i class="fas fa-heartbeat text-red-500 mr-2"></i>Emergencia</h3>
                                <div><p class="text-[10px] font-bold text-zinc-500 uppercase">Contacto</p><p class="text-sm font-bold text-white">Maria Hucke (Madre)</p></div>
                                <div class="mt-2"><p class="text-[10px] font-bold text-zinc-500 uppercase">Fono</p><p class="text-sm font-bold text-white">+56 9 9876 5432</p></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </section>

    <section id="layout-admin" class="view-section w-full h-full hidden">
        <aside class="w-64 bg-black border-r border-zinc-800 flex flex-col flex-shrink-0 z-20">
            <div class="h-16 flex items-center px-6 border-b border-zinc-800">
                <span class="font-black italic text-xl tracking-tight text-white">ADMIN<span class="text-motus-green">PANEL</span></span>
            </div>
            <nav class="flex-1 px-3 py-6 space-y-1">
                <p class="px-3 text-[10px] font-bold text-zinc-500 uppercase tracking-widest mb-2">Gesti√≥n</p>
                <button onclick="navTo('admin-dashboard', this); renderAdminStats();" class="nav-item active w-full flex items-center gap-3 px-3 py-2.5 rounded-r-lg text-zinc-400 hover:bg-zinc-900 hover:text-white transition group"><i class="fas fa-chart-pie w-5 text-center group-hover:text-motus-green"></i> <span class="font-medium">Dashboard</span></button>
                <button onclick="navTo('admin-users', this); renderTablaUsuarios();" class="nav-item w-full flex items-center gap-3 px-3 py-2.5 rounded-r-lg text-zinc-400 hover:bg-zinc-900 hover:text-white transition group"><i class="fas fa-users w-5 text-center group-hover:text-motus-green"></i> <span class="font-medium">Usuarios</span></button>
            </nav>
            <div class="p-4 border-t border-zinc-800 flex items-center gap-3">
                <div class="w-8 h-8 rounded bg-zinc-800 flex items-center justify-center text-zinc-400 text-xs font-bold"><i class="fas fa-shield-alt"></i></div>
                <div class="flex-1"><p class="text-xs font-bold text-white">Felipe B.</p><p class="text-[10px] text-zinc-500">Admin</p></div>
                <button onclick="logout()" class="text-zinc-500 hover:text-red-500"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </aside>

        <main class="flex-1 overflow-y-auto bg-zinc-950 p-8 relative">
            <div id="admin-dashboard" class="content-panel active-view flex-col max-w-7xl mx-auto w-full">
                <h1 class="text-2xl font-bold text-white mb-6">Resumen Gerencial</h1>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-zinc-900 border border-zinc-800 p-6 rounded-xl"><p class="text-zinc-500 text-xs font-bold uppercase">Socios Activos</p><p id="stat-socios" class="text-3xl font-black text-white mt-2">1,240</p><span class="text-green-500 text-xs font-bold"><i class="fas fa-arrow-up"></i> +5%</span></div>
                    <div class="bg-zinc-900 border border-zinc-800 p-6 rounded-xl border-b-4 border-red-500"><p class="text-zinc-500 text-xs font-bold uppercase">Tasa Churn</p><p class="text-3xl font-black text-white mt-2">3.4%</p><span class="text-red-500 text-xs font-bold"><i class="fas fa-arrow-down"></i> +0.5%</span></div>
                    <div class="bg-zinc-900 border border-zinc-800 p-6 rounded-xl"><p class="text-zinc-500 text-xs font-bold uppercase">Reservas Hoy</p><p id="stat-reservas-hoy" class="text-3xl font-black text-white mt-2">0</p></div>
                </div>
            </div>

            <div id="admin-users" class="content-panel hidden flex-col max-w-7xl mx-auto w-full">
                <div class="flex justify-between items-center mb-6"><h2 class="text-2xl font-bold text-white">Usuarios</h2><button class="bg-motus-green text-black text-xs font-bold px-4 py-2 rounded hover:bg-lime-400">+ Nuevo</button></div>
                <div class="bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden">
                    <table class="w-full text-left text-sm">
                        <thead class="bg-black border-b border-zinc-800"><tr><th class="p-4 text-zinc-500 font-bold uppercase text-xs">Nombre</th><th class="p-4 text-zinc-500 font-bold uppercase text-xs">Plan</th><th class="p-4 text-zinc-500 font-bold uppercase text-xs">Estado</th></tr></thead>
                        <tbody id="tabla-usuarios-body" class="divide-y divide-zinc-800">
                            </tbody>
                    </table>
                </div>
            </div>
        </main>
    </section>

    <script>
        // --- 1. DATOS SIMULADOS (MOCK DB) ---
        const db = {
            usuarios: [
                { id: 1, rut: "12.345.678-9", nombre: "Armin Hucke", email: "armin@motus.cl", pass: "1234", rol: "socio", plan: "Full Access" },
                { id: 2, rut: "11.222.333-4", nombre: "Juan P√©rez", email: "juan@motus.cl", pass: "1234", rol: "socio", plan: "8 Clases" },
                { id: 99, rut: "admin", nombre: "Felipe B.", email: "admin@motus.cl", pass: "admin", rol: "admin", plan: "Staff" }
            ],
            clases: [
                { id: 101, dia: "mar", hora: "10:00", nombre: "ZUMBA", sala: "Sala 2", coach: "Ana", cuposTot: 5, cuposOc: 4 },
                { id: 102, dia: "mar", hora: "12:00", nombre: "Nutrici√≥n", sala: "Box 1", coach: "Dra. Soto", cuposTot: 1, cuposOc: 0 },
                { id: 103, dia: "mar", hora: "18:00", nombre: "Crossfit", sala: "Box Cross", coach: "Pedro", cuposTot: 20, cuposOc: 20 }, // Lleno
                { id: 104, dia: "lun", hora: "09:00", nombre: "Funcional", sala: "Sala 1", coach: "Luis", cuposTot: 10, cuposOc: 2 },
                { id: 105, dia: "mie", hora: "19:00", nombre: "Yoga Flow", sala: "Zen", coach: "Maria", cuposTot: 15, cuposOc: 5 }
            ],
            reservas: [] // Se llena din√°micamente
        };

        // Persistencia Simple (Opcional): Cargar reservas de localStorage si existen
        if(localStorage.getItem('motus_reservas')) {
            db.reservas = JSON.parse(localStorage.getItem('motus_reservas'));
            // Actualizar cupos visualmente basado en reservas guardadas
            db.reservas.forEach(r => {
                const c = db.clases.find(cl => cl.id === r.idClase);
                if(c && c.cuposOc < c.cuposTot) c.cuposOc++;
            });
        }

        let usuarioSesion = null;

        // --- 2. FUNCIONES DE ACCESO ---
        function intentarLogin() {
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-pass').value;
            const user = db.usuarios.find(u => u.email === email && u.pass === pass);

            if (user) {
                iniciarSesion(user);
            } else {
                alert("Credenciales incorrectas.");
            }
        }

        function loginAdminDemo() {
            // Funci√≥n para el bot√≥n "Acceso Administrativo"
            document.getElementById('login-email').value = "admin@motus.cl";
            document.getElementById('login-pass').value = "admin";
            intentarLogin();
        }

        function iniciarSesion(usuario) {
            usuarioSesion = usuario;
            document.getElementById('auth-layout').classList.remove('active-view');
            
            setTimeout(() => {
                document.getElementById('auth-layout').style.display = 'none';
                const layoutId = usuario.rol === 'admin' ? 'layout-admin' : 'layout-socio';
                const layout = document.getElementById(layoutId);
                layout.classList.remove('hidden');
                layout.style.display = 'flex';
                setTimeout(() => layout.classList.add('active-view'), 10);

                if (usuario.rol === 'socio') cargarDatosSocio();
                if (usuario.rol === 'admin') renderAdminStats();
            }, 300);
        }

        function logout() {
            usuarioSesion = null;
            location.reload();
        }

        // --- 3. FUNCIONES SOCIO ---
        function cargarDatosSocio() {
            // Header y Sidebar
            document.getElementById('news-nombre').innerText = usuarioSesion.nombre.split(' ')[0];
            document.getElementById('mini-nombre').innerText = usuarioSesion.nombre;
            const iniciales = usuarioSesion.nombre.substring(0,2).toUpperCase();
            document.getElementById('mini-avatar').innerText = iniciales;
            document.getElementById('profile-initials').innerText = iniciales;

            // Perfil
            document.getElementById('profile-name-main').innerText = usuarioSesion.nombre;
            document.getElementById('info-nombre').innerText = usuarioSesion.nombre;
            document.getElementById('info-rut').innerText = usuarioSesion.rut;
            document.getElementById('info-email').innerText = usuarioSesion.email;
            document.getElementById('info-plan').innerText = usuarioSesion.plan;

            actualizarWidgetProximaSesion();
            cargarListaReservasPerfil();
        }

        function actualizarWidgetProximaSesion() {
            const container = document.getElementById('next-session-card');
            const misReservas = db.reservas.filter(r => r.idUsuario === usuarioSesion.id);
            
            if (misReservas.length > 0) {
                const ultima = misReservas[misReservas.length - 1]; // Tomar la √∫ltima agregada
                const clase = db.clases.find(c => c.id === ultima.idClase);
                container.innerHTML = `
                    <div class="absolute top-0 right-0 bg-motus-green text-black text-[10px] font-bold px-2 py-1 rounded-bl-lg uppercase">Pr√≥xima sesi√≥n</div>
                    <h3 class="text-3xl font-black italic text-white mt-2 mb-1">${clase.nombre}</h3>
                    <p class="text-zinc-400 text-sm mb-4">${clase.dia.toUpperCase()} ${clase.hora} ‚Ä¢ ${clase.sala}</p>
                    <button onclick="navTo('socio-calendar', document.querySelectorAll('#layout-socio .nav-item')[1]); renderizarCalendario();" class="w-full bg-zinc-800 hover:bg-zinc-700 text-white py-2 rounded-lg text-xs font-bold uppercase transition">Ver en Agenda</button>
                `;
            } else {
                container.innerHTML = `<div class="text-center text-zinc-500 italic"><p>No tienes reservas pr√≥ximas</p></div>`;
            }
        }

        // --- 4. CALENDARIO Y RESERVAS ---
        function renderizarCalendario() {
            ['lun','mar','mie','jue','vie'].forEach(d => document.getElementById(`col-${d}`).innerHTML = '');
            
            db.clases.forEach(clase => {
                const cuposDisp = clase.cuposTot - clase.cuposOc;
                const estaLleno = cuposDisp <= 0;
                const yaReservada = db.reservas.some(r => r.idUsuario === usuarioSesion.id && r.idClase === clase.id);
                
                let cardClass = estaLleno ? 'border-zinc-700 opacity-60' : 'border-zinc-700 hover:border-motus-green';
                if (yaReservada) cardClass = 'border-motus-green bg-motus-green/5';

                const btnHtml = yaReservada 
                    ? `<button onclick="cancelarReserva(${clase.id})" class="w-full py-1.5 bg-red-900/20 text-red-500 border border-red-900/50 rounded text-[10px] font-bold uppercase hover:bg-red-900 hover:text-white transition">Cancelar</button>`
                    : `<button onclick="reservarClase(${clase.id})" ${estaLleno ? 'disabled' : ''} class="w-full py-1.5 ${estaLleno ? 'bg-zinc-800 text-zinc-600 cursor-not-allowed' : 'bg-zinc-100 text-black hover:bg-motus-green'} rounded text-[10px] font-bold uppercase transition">${estaLleno ? 'Agotado' : 'Reservar'}</button>`;

                const html = `
                    <div class="bg-zinc-900 p-0 rounded-xl border ${cardClass} transition group relative overflow-hidden shadow-lg flex flex-col">
                        <div class="bg-zinc-800 px-3 py-2 flex justify-between items-center border-b border-zinc-700">
                            <span class="text-[10px] font-black text-black bg-motus-green px-2 py-0.5 rounded">${clase.hora}</span>
                            ${yaReservada ? '<i class="fas fa-check-circle text-motus-green"></i>' : ''}
                        </div>
                        <div class="p-3">
                            <h4 class="font-black text-white italic mb-1 uppercase">${clase.nombre}</h4>
                            <p class="text-xs text-zinc-400 mb-3">${clase.sala}</p>
                            <div class="flex justify-between text-[10px] text-zinc-400 mb-1 font-bold"><span>Cupos</span><span class="${estaLleno?'text-red-500':'text-white'}">${estaLleno?'FULL':cuposDisp}</span></div>
                            <div class="w-full bg-zinc-700 h-1.5 rounded-full overflow-hidden mb-3"><div class="${estaLleno?'bg-red-500':'bg-motus-green'} h-full rounded-full" style="width: ${(clase.cuposOc/clase.cuposTot)*100}%"></div></div>
                            ${btnHtml}
                        </div>
                    </div>`;
                
                const col = document.getElementById(`col-${clase.dia}`);
                if(col) col.innerHTML += html;
            });
        }

        function reservarClase(idClase) {
            const clase = db.clases.find(c => c.id === idClase);
            if(clase && clase.cuposOc < clase.cuposTot) {
                clase.cuposOc++;
                db.reservas.push({ idUsuario: usuarioSesion.id, idClase: idClase });
                guardarDatos();
                alert("‚úÖ Reserva confirmada");
                renderizarCalendario();
                actualizarWidgetProximaSesion();
            }
        }

        function cancelarReserva(idClase) {
            if(confirm("¬øCancelar reserva?")) {
                const index = db.reservas.findIndex(r => r.idUsuario === usuarioSesion.id && r.idClase === idClase);
                if(index > -1) {
                    db.reservas.splice(index, 1);
                    db.clases.find(c => c.id === idClase).cuposOc--;
                    guardarDatos();
                    alert("üóëÔ∏è Reserva cancelada");
                    renderizarCalendario();
                    actualizarWidgetProximaSesion();
                    cargarListaReservasPerfil(); // Actualizar si estamos en perfil
                }
            }
        }

        function cargarListaReservasPerfil() {
            const lista = document.getElementById('lista-reservas-perfil');
            lista.innerHTML = '';
            const mis = db.reservas.filter(r => r.idUsuario === usuarioSesion.id);
            if(mis.length === 0) { lista.innerHTML = '<p class="text-zinc-500 text-xs">Sin reservas activas.</p>'; return; }
            
            mis.forEach(r => {
                const c = db.clases.find(cl => cl.id === r.idClase);
                lista.innerHTML += `
                    <div class="flex justify-between items-center bg-zinc-800 p-2 rounded border border-zinc-700 mb-2">
                        <div><p class="text-white text-xs font-bold">${c.nombre}</p><p class="text-zinc-500 text-[10px]">${c.dia.toUpperCase()} ${c.hora}</p></div>
                        <button onclick="cancelarReserva(${c.id})" class="text-red-500 text-[10px] hover:text-white">Cancelar</button>
                    </div>`;
            });
        }

        // --- 5. FUNCIONES ADMIN ---
        function renderAdminStats() {
            // Stats reales
            document.getElementById('stat-socios').innerText = db.usuarios.filter(u => u.rol === 'socio').length;
            const reservasHoy = db.reservas.filter(r => {
                const c = db.clases.find(cl => cl.id === r.idClase);
                return c.dia === 'mar'; // Simulamos que hoy es Martes
            }).length;
            document.getElementById('stat-reservas-hoy').innerText = reservasHoy;
        }

        function renderTablaUsuarios() {
            const tbody = document.getElementById('tabla-usuarios-body');
            tbody.innerHTML = '';
            db.usuarios.forEach(u => {
                tbody.innerHTML += `
                    <tr class="hover:bg-zinc-800 transition">
                        <td class="p-4 font-bold text-white">${u.nombre}</td>
                        <td class="p-4 text-zinc-400">${u.plan}</td>
                        <td class="p-4"><span class="bg-green-900 text-green-400 px-2 py-0.5 rounded text-[10px] font-bold uppercase">Activo</span></td>
                    </tr>`;
            });
        }

        // --- UTILIDADES ---
        function guardarDatos() {
            localStorage.setItem('motus_reservas', JSON.stringify(db.reservas));
        }

        function toggleAuth(view) {
            const login = document.getElementById('form-login');
            const reg = document.getElementById('form-register');
            if(view === 'register') { login.classList.add('hidden'); reg.classList.remove('hidden'); }
            else { reg.classList.add('hidden'); login.classList.remove('hidden'); }
        }

        function navTo(viewId, btn) {
            const parent = btn.closest('.view-section');
            parent.querySelectorAll('.content-panel').forEach(p => { p.classList.add('hidden'); p.classList.remove('active-view'); });
            const target = document.getElementById(viewId);
            target.classList.remove('hidden');
            setTimeout(() => target.classList.add('active-view'), 10);
            parent.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            btn.classList.add('active');
        }

        // REGISTRO
        function registrarUsuario() {
            const nombre = document.getElementById('reg-nombre').value;
            const rut = document.getElementById('reg-rut').value;
            const email = document.getElementById('reg-email').value;
            const pass = document.getElementById('reg-pass').value;
            if(!nombre || !email || !pass) { alert("Completa los datos"); return; }
            
            db.usuarios.push({ id: Date.now(), rut, nombre, email, pass, rol: "socio", plan: "B√°sico" });
            alert("Cuenta creada");
            toggleAuth('login');
            document.getElementById('login-email').value = email;
            document.getElementById('login-pass').value = pass;
        }
    </script>
</body>
</html>